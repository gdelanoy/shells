#!/bin/sh

# Matches: 192.168.0.1
ipextract ()
{
grep -E --only-matching '(25[0-5]|2[0-4][0-9]|[01]?[0-9]{2}?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9]{2}?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9]{2}?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9]{2}?)'
}

# Matches: 192.168.0.1
ipextractlegacy ()
{
grep -E --only-matching '([[:digit:]]{1,3}\.){3}[[:digit:]]{1,3}'
}

# Matches: fe80::7ed1:c3ff:feec:dee1
ipextract6 ()
{
grep --only-matching -E '(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]).){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]).){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))'
}

# Matches: 127.0.0.1.1023
# netstat style
ipextractplusport ()
{
grep -E --only-matching '(25[0-5]|2[0-4][0-9]|[01]?[0-9]{2}?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9]{2}?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9]{2}?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9]{2}?)\.[[:digit:]]+'
}

ipextract ()
{
grep -E --only-matching '(25[0-5]|2[0-4][0-9]|[01]?[0-9]{2}?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9]{2}?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9]{2}?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9]{2}?)'
}


# Matches: 192.168.0.0/24
ipextractnet ()
{
grep -E --only-matching '(25[0-5]|2[0-4][0-9]|[01]?[0-9]{2}?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9]{2}?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9]{2}?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9]{2}?)/[[:digit:]]+'
}

# Matches: 80/tcp
ipextracttcp ()
{
grep -E --only-matching '[[:digit:]]+/tcp'
}

# Matches: 53/udp
ipextractudp ()
{
grep -E --only-matching '[[:digit:]]+/udp'
}

# Matches: 2905/sctp
ipextractsctp ()
{
grep -E --only-matching '[[:digit:]]+/sctp'
}

# Matches: www.eff.org
ipextractfqdn ()
{
grep -E --only-matching '[a-zA-Z0-9]+[a-zA-Z0-9\-\.]*\.[a-zA-Z]{2,}'
}

